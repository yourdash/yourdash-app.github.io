import{r as d,t as le,j as e,B as H,k as b,h,Y as W,P as g,b as x,g as L,d as v,e as ee,s as Y,o as se,Z as J,H as te,f as ue,i as ae,T as de}from"./index-5c94e495.js";import{c as me,b as C,O as he,R as pe,a as N}from"./index-81be8c96.js";import{B as D}from"./buttonWithIcon-f4fd35bd.js";import{P as ge}from"./progressBar-14ede56d.js";/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function X(s){return s===void 0&&(s=""),new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((a,n)=>{let t=s[n];return a.concat(Array.isArray(t)?t.map(o=>[n,o]):[[n,t]])},[]))}function be(s,a){let n=X(s);return a&&a.forEach((t,o)=>{n.has(o)||a.getAll(o).forEach(r=>{n.append(o,r)})}),n}const xe="6";try{window.__reactRouterVersion=xe}catch{}var Z;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(Z||(Z={}));var q;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(q||(q={}));function ne(s){let a=d.useRef(X(s)),n=d.useRef(!1),t=me(),o=d.useMemo(()=>be(t.search,n.current?null:a.current),[t.search]),r=C(),m=d.useCallback((i,l)=>{const u=X(typeof i=="function"?i(o):i);n.current=!0,r("?"+u,l)},[r,o]);return[o,m]}const _e="_navigation_1vis6_10",fe="_applicationFrame_1vis6_22",je="_applicationView_1vis6_30",E={navigation:_e,applicationFrame:fe,applicationView:je},ve={id:"uk-ewsgit-photos",displayName:"Photos",description:"This is the default application description, you can edit this information in this application's 'application.json'",category:"core",license:"MIT",maintainers:[{name:"Ewsgit",avatarUrl:"https://avatars.githubusercontent.com/u/69800526?v=4",bio:"The creator of YourDash",url:"https://ewsgit.uk"}],authors:[{name:"Ewsgit",avatarUrl:"https://avatars.githubusercontent.com/u/69800526?v=4",bio:"The creator of YourDash",url:"https://ewsgit.uk"}],modules:{backend:[{dependencies:[],description:"The backend for the Photos application",id:"uk-ewsgit-photos-backend",main:"./backend/index.ts"}],frontend:[],officialFrontend:[{id:"uk-ewsgit-photos-frontend",main:"./web/index.tsx",displayName:"Photos",iconPath:"./icon.avif",description:"",dependencies:[{moduleType:"backend",id:"uk-ewsgit-photos-backend"}]}]},shouldInstanceRestartOnInstall:!0,__internal__generatedFor:"officialFrontend"},oe=new le("/app/uk-ewsgit-photos-backend"),ce=()=>{const s=C();return a=>s("/app/a/uk-ewsgit-photos-frontend"+a)},we=()=>{const s=ce();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:E.applicationFrame,children:[e.jsx("div",{className:E.applicationView,children:e.jsx(he,{})}),e.jsxs(H,{className:E.navigation,children:[e.jsx(b,{accessibleLabel:"Home",icon:h.Home,onClick:()=>{s("/")}}),e.jsx(b,{accessibleLabel:"Search",icon:h.Search,onClick:()=>{s("/search/")}}),e.jsx(b,{accessibleLabel:"Profile",icon:h.Person,onClick:()=>{s("/profile/")}})]})]})})},Pe="_component_fi888_6",Se="_items_fi888_15",Ne="_endOfItems_fi888_19",B={component:Pe,items:Se,endOfItems:Ne},re=({children:s,fetchNextPage:a,containerClassName:n,className:t,hasMorePages:o,resetState:r,dontShowNoMoreItems:m})=>{const i=W.useRef(null),[l,u]=g.useState(!0),p=W.useRef(-1);g.useEffect(()=>{p.current=-1,u(!0)},[r]);const _=async()=>{o&&(p.current++,u(!0),await a(p.current),u(!1))};return g.useEffect(()=>{if(!i.current)return;_();const U=i.current;new IntersectionObserver(c=>{c[0].isIntersecting&&_()}).observe(U)},[]),x.jsxs("div",{className:L(n,B.component),children:[x.jsx("div",{className:L(t,B.items),children:s}),l&&x.jsx("div",{children:"Loading more content"}),!o&&x.jsx("div",{children:"No More Pages Exist"}),x.jsx("div",{ref:i,className:B.endOfItems,children:!m})]})},ye=()=>e.jsx(e.Fragment,{children:"Album Media"}),Le="_component_3bjn0_10",Ce="_album_3bjn0_18",$e="_thumbnailContainer_3bjn0_26",Re="_thumbnail_3bjn0_26",Ie={component:Le,album:Ce,thumbnailContainer:$e,thumbnail:Re},G=({path:s,scrollerClassName:a})=>{C();const[n,t]=d.useState([]),[o,r]=d.useState(!0);return d.useEffect(()=>{r(!0),t([])},[s]),e.jsx(re,{hasMorePages:o,resetState:s,fetchNextPage:async m=>{const i=await oe.getJson(`/album/media/${m}/@`+s);t(l=>[...l,...i])},className:L(Ie.component,a),children:n.map(m=>e.jsx(ye,{}))})},Fe="_component_3bjn0_10",ke="_album_3bjn0_18",Te="_thumbnailContainer_3bjn0_26",Ue="_thumbnail_3bjn0_26",R={component:Fe,album:ke,thumbnailContainer:Te,thumbnail:Ue},z=({path:s,scrollerClassName:a})=>{const n=v.getCurrentModuleId(ve),t=C(),[o,r]=d.useState([]),[m,i]=d.useState(!0);return d.useEffect(()=>{i(!0),r([])},[s]),o?e.jsx(re,{hasMorePages:m,resetState:s,fetchNextPage:async l=>{const u=await oe.getJson(`/album/sub/${l}/@`+s);(u==null?void 0:u.length)===0&&i(!1),r(p=>[...p,...u])},className:L(R.component,a),children:o.map(l=>e.jsxs(ee,{containerClassName:R.album,onClick:()=>{t(`/app/a/${n}/album/?p=`+v.path.toUnix(l.path))},children:[e.jsx(Y,{containerClassName:R.thumbnailContainer,className:R.thumbnail,accessibleLabel:"",authenticatedImage:!0,src:l.thumbnail}),e.jsx(se,{text:l.displayName})]},l.path))}):null},Ve="_header_17zt7_10",Ae="_heading_17zt7_18",Me="_page_17zt7_22",Ee="_contentView_17zt7_27",Be="_subAlbums_17zt7_34",Xe="_mediaGrid_17zt7_38",y={header:Ve,heading:Ae,page:Me,contentView:Ee,subAlbums:Be,mediaGrid:Xe},Ye=()=>{const s=ce(),[a]=ne(),n=a.get("p")||"";return e.jsxs("div",{className:y.page,children:[e.jsxs("div",{className:y.header,children:[e.jsx(b,{accessibleLabel:"Go back",icon:h.ChevronLeft,onClick:()=>{const t=J.join(n,"..");if(t==="/"&&n==="/"){s("/");return}s(`/album/?p=${t}`)}}),e.jsx(te,{className:y.heading,level:1,text:J.basename(n)||n})]}),e.jsx(z,{scrollerClassName:y.subAlbums,path:n||"/"}),e.jsx(G,{scrollerClassName:y.mediaGrid,path:n||"/"})]})},Ge=""+new URL("photosLogo-7e4e3549.png",import.meta.url).href,ze="_header_fc37t_10",Oe="_brandName_fc37t_20",We="_brandLogo_fc37t_24",Je="_page_fc37t_30",I={header:ze,brandName:Oe,brandLogo:We,page:Je},De=()=>e.jsxs(e.Fragment,{children:[e.jsxs(H,{className:I.header,children:[e.jsx(Y,{disableLazyLoading:!0,accessibleLabel:"Photos logo",src:Ge,className:I.brandLogo}),e.jsx(te,{className:I.brandName,text:"Photos",level:3})]}),e.jsxs("div",{className:I.page,children:[e.jsx(z,{path:"/photos"}),e.jsx(G,{path:"/photos"})]})]}),Ze=({results:s})=>e.jsx(e.Fragment,{children:s.map(a=>e.jsx(e.Fragment,{children:a.fileName}))}),qe="_page_68cfa_10",Ke="_searchBar_68cfa_18",Qe="_subAlbums_68cfa_29",F={page:qe,searchBar:Ke,subAlbums:Qe},He=()=>{const[s,a]=ue.useState(""),n=ae(()=>v.getJson("/app/photos/media/search/"),[s]);return e.jsxs("div",{className:F.page,children:[e.jsx(de,{className:F.searchBar,accessibleName:"Search Media",onChange:t=>{a(t)},placeholder:"Search Media...",icon:h.Search}),n&&e.jsx(Ze,{results:n}),e.jsx(z,{scrollerClassName:F.subAlbums,path:"/photos"}),e.jsx(G,{scrollerClassName:F.subAlbums,path:"/photos"})]})},ie=({children:s,minZoom:a,maxZoom:n,onScaleChange:t})=>{const o=g.useRef(null),[r,m]=g.useState(0),[i,l]=g.useState(0),[u,p]=g.useState(1);t&&g.useEffect(()=>{t(u)},[u]);const _=c=>{c.stopPropagation();const f=c.deltaY,w=u+f/1e3;p(Math.min(Math.max(w,a??.1),n??10))},U=c=>{c.stopPropagation();const f=c.clientX,w=c.clientY,V=r,$=i,P=j=>{j.stopPropagation();const A=j.clientX-f,M=j.clientY-w;m(V+A),l($+M)},S=()=>{c.stopPropagation(),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",S)};document.addEventListener("mousemove",P),document.addEventListener("mouseup",S)},O=c=>{c.stopPropagation();const f=c.touches,w=r,V=i,$=S=>{S.stopPropagation();const j=S.touches,A=j[0].clientX-f[0].clientX,M=j[0].clientY-f[0].clientY;m(w+A),l(V+M)},P=()=>{c.stopPropagation(),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",P)};document.addEventListener("touchmove",$),document.addEventListener("touchend",P)};return x.jsx("div",{ref:o,style:{width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},onWheel:_,onMouseDown:U,onTouchStart:O,onDragStart:c=>{c.stopPropagation(),c.preventDefault()},onContextMenu:c=>{c.preventDefault(),c.stopPropagation()},children:x.jsx("div",{style:{transform:`translate(${r}px, ${i}px) scale(${u})`,transformOrigin:"center center",maxWidth:"max-content",pointerEvents:"none"},children:s})})},es="_viewVideo_reil1_10",ss="_controls_reil1_18",K={viewVideo:es,controls:ss},ts=({mediaUrl:s})=>{const a=d.useRef(null),[n,t]=d.useState(!1),[o,r]=d.useState(!1),[m,i]=d.useState(0),[l,u]=d.useState(0),[p,_]=d.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:e.jsx("video",{onCanPlayThrough:()=>t(!0),onPlay:()=>{r(!0)},onPause:()=>{r(!1)},onDurationChange:()=>{i(a.current.duration)},onTimeUpdate:()=>{u(a.current.currentTime)},loop:p,ref:a,draggable:!1,autoPlay:!0,className:K.viewVideo,src:v.getInstanceUrl()+s})}),n&&e.jsx(e.Fragment,{children:m>0&&e.jsxs("div",{className:K.controls,children:[e.jsx(b,{accessibleLabel:"Rewind",icon:h.ArrowLeft,onClick:()=>{a.current.currentTime-=2}}),e.jsx(b,{accessibleLabel:"Play / Pause",icon:o?h.Stop:h.Play,onClick:()=>{o?a.current.pause():a.current.play()}}),e.jsx(b,{accessibleLabel:"Fast Forward",icon:h.ArrowRight,onClick:()=>{a.current.currentTime+=2}}),e.jsx(ge,{value:l/m}),e.jsx(b,{accessibleLabel:"Loop",icon:p?h.CrossReference:h.FeedMerged,onClick:()=>{_(!p)}})]})})]})},as="_page_1nb23_10",ns="_video_1nb23_18",os="_header_1nb23_22",cs="_heading_1nb23_37",rs="_spacer_1nb23_41",k={page:as,video:ns,header:os,heading:cs,spacer:rs},is="_viewImage_12s9m_6",ls="_scale_12s9m_15",Q={viewImage:is,scale:ls},us=({mediaUrl:s})=>{const[a,n]=d.useState(1);return e.jsx(e.Fragment,{children:e.jsxs(ie,{onScaleChange:t=>n(t),children:[e.jsx(Y,{className:Q.viewImage,src:s,authenticatedImage:!0,accessibleLabel:""}),e.jsx(ee,{className:Q.scale,children:e.jsx(se,{text:`${a*100}% scale`})})]})})};var T=(s=>(s[s.Image=0]="Image",s[s.Video=1]="Video",s[s.Unknown=2]="Unknown",s))(T||{});const ds=()=>{const[s]=ne(),a=s.get("p")||"",n=C(),t=ae(()=>v.getJson(`/app/photos/media/raw/@/${a}`),[a]);return e.jsxs("div",{className:L(k.page,(t==null?void 0:t.type)===T.Video&&k.video),children:[e.jsxs("div",{className:k.header,children:[e.jsx(D,{text:"Go Back",icon:h.ChevronLeft,onClick:()=>{n(-1)}}),e.jsx("div",{className:k.spacer}),e.jsx(D,{text:"Download",icon:h.Download,onClick:()=>{window.open(`${v.getInstanceUrl()}${t==null?void 0:t.mediaUrl}`,"_blank")}})]}),t&&e.jsxs(e.Fragment,{children:[t.type===T.Image&&e.jsx(us,{mediaUrl:t.mediaUrl}),t.type===T.Video&&e.jsx(ts,{mediaUrl:t.mediaUrl})]})]})},bs=()=>e.jsx(pe,{children:e.jsxs(N,{element:e.jsx(we,{}),children:[e.jsx(N,{index:!0,element:e.jsx(De,{})}),e.jsx(N,{path:"search",element:e.jsx(He,{})}),e.jsx(N,{path:"album",element:e.jsx(Ye,{})}),e.jsx(N,{path:"view",element:e.jsx(ds,{})})]})});export{bs as default};
