import{r as n,j as e,f as d,Y as b,T as h,c as f,B as u}from"./index-01aaedfa.js";import{T as g}from"./TextBox-6a285a1c.js";const m=({item:t,setItemData:l,removeKey:s})=>{const[a,r]=n.useState(!1),[c,x]=n.useState(""),[i,p]=n.useState("");return n.useEffect(()=>{x(t.key),p(t.content)},[t]),e.jsxs("div",{className:"bg-container-bg text-container-fg flex gap-4 p-2 rounded-xl",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(d,{icon:a?b.ChevronUp:b.ChevronDown,onClick:()=>r(!a),className:"flex-shrink-0"}),a&&e.jsx(d,{icon:b.Check,onClick:()=>{if(!(c===""||i==="")){try{JSON.parse(i)}catch{return}c!==t.key&&s(t.key),l(c,i)}},className:"flex-shrink-0"})]}),a?e.jsx(h,{onBlur:o=>{x(o.currentTarget.value)},onChange:o=>{x(o)},defaultValue:c,className:"mt-auto mb-auto flex-shrink-0"}):e.jsx("span",{className:"mt-auto mb-auto",children:c}),a&&e.jsx(g,{className:"flex flex-shrink",defaultValue:i,onChange:o=>{p(o.currentTarget.value)}})]})},v=()=>{const[t,l]=n.useState({});return n.useEffect(()=>{f.getJson("/app/global_db/db",s=>{s.db&&l(s.db)})},[]),e.jsxs("div",{className:"flex flex-col gap-2 relative min-h-full pt-2 bg-bg",children:[e.jsxs("div",{className:"flex flex-col w-full pl-2 pr-2 pb-20 h-full overflow-y-auto gap-2",children:[Object.keys(t).map(s=>e.jsx(m,{removeKey:a=>{l({...Object.keys(t).filter(r=>r!==a)})},setItemData:(a,r)=>{l({...t,[a]:JSON.parse(r)})},item:{key:s,content:JSON.stringify(t[s],null,2)}},s)),e.jsx(u,{onClick:()=>{l({...t,[`untitled_${Math.floor(Math.random()*1e3)}`]:{}})},children:"Create Database Key"})]}),e.jsxs("footer",{className:"w-full flex bg-container-bg border-t-[1px] border-t-container-border p-2 gap-2 absolute bottom-0 left-0",children:[e.jsx(u,{onClick:()=>{f.postJson("/app/global_db/db",t,()=>{})},children:"Save"}),e.jsx(u,{onClick:()=>{f.getJson("/app/global_db/db",s=>{s.db&&l(s.db)})},children:"Reload"}),e.jsx(u,{onClick:()=>{f.postJson("/app/global_db/db/force-write",t,()=>{})},children:"Force write"})]})]})};export{v as G};
