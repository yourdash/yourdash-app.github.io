import{i as T,d as N,h as _,j as a,M as E,B as C,r as g,c as w,f as P,Y as b,e as D,I as A,b as B,R as F,a as L}from"./index-01aaedfa.js";import{R as J}from"./RightClickMenu-d0fd3324.js";import{g as k,C as z,a as S}from"./editor-335f8fc2.js";function m(l){if(typeof l!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(l))}function p(l,e){for(var r="",s=0,t=-1,i=0,n,o=0;o<=l.length;++o){if(o<l.length)n=l.charCodeAt(o);else{if(n===47)break;n=47}if(n===47){if(!(t===o-1||i===1))if(t!==o-1&&i===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){c===-1?(r="",s=0):(r=r.slice(0,c),s=r.length-1-r.lastIndexOf("/")),t=o,i=0;continue}}else if(r.length===2||r.length===1){r="",s=0,t=o,i=0;continue}}e&&(r.length>0?r+="/..":r="..",s=2)}else r.length>0?r+="/"+l.slice(t+1,o):r=l.slice(t+1,o),s=o-t-1;t=o,i=0}else n===46&&i!==-1?++i:i=-1}return r}function $(l,e){var r=e.dir||e.root,s=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+s:r+l+s:s}var h={resolve:function(){for(var e="",r=!1,s,t=arguments.length-1;t>=-1&&!r;t--){var i;t>=0?i=arguments[t]:(s===void 0&&(s=process.cwd()),i=s),m(i),i.length!==0&&(e=i+"/"+e,r=i.charCodeAt(0)===47)}return e=p(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(m(e),e.length===0)return".";var r=e.charCodeAt(0)===47,s=e.charCodeAt(e.length-1)===47;return e=p(e,!r),e.length===0&&!r&&(e="."),e.length>0&&s&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return m(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var s=arguments[r];m(s),s.length>0&&(e===void 0?e=s:e+="/"+s)}return e===void 0?".":h.normalize(e)},relative:function(e,r){if(m(e),m(r),e===r||(e=h.resolve(e),r=h.resolve(r),e===r))return"";for(var s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var t=e.length,i=t-s,n=1;n<r.length&&r.charCodeAt(n)===47;++n);for(var o=r.length,c=o-n,d=i<c?i:c,u=-1,f=0;f<=d;++f){if(f===d){if(c>d){if(r.charCodeAt(n+f)===47)return r.slice(n+f+1);if(f===0)return r.slice(n+f)}else i>d&&(e.charCodeAt(s+f)===47?u=f:f===0&&(u=0));break}var y=e.charCodeAt(s+f),R=r.charCodeAt(n+f);if(y!==R)break;y===47&&(u=f)}var j="";for(f=s+u+1;f<=t;++f)(f===t||e.charCodeAt(f)===47)&&(j.length===0?j+="..":j+="/..");return j.length>0?j+r.slice(n+u):(n+=u,r.charCodeAt(n)===47&&++n,r.slice(n))},_makeLong:function(e){return e},dirname:function(e){if(m(e),e.length===0)return".";for(var r=e.charCodeAt(0),s=r===47,t=-1,i=!0,n=e.length-1;n>=1;--n)if(r=e.charCodeAt(n),r===47){if(!i){t=n;break}}else i=!1;return t===-1?s?"/":".":s&&t===1?"//":e.slice(0,t)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');m(e);var s=0,t=-1,i=!0,n;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var o=r.length-1,c=-1;for(n=e.length-1;n>=0;--n){var d=e.charCodeAt(n);if(d===47){if(!i){s=n+1;break}}else c===-1&&(i=!1,c=n+1),o>=0&&(d===r.charCodeAt(o)?--o===-1&&(t=n):(o=-1,t=c))}return s===t?t=c:t===-1&&(t=e.length),e.slice(s,t)}else{for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!i){s=n+1;break}}else t===-1&&(i=!1,t=n+1);return t===-1?"":e.slice(s,t)}},extname:function(e){m(e);for(var r=-1,s=0,t=-1,i=!0,n=0,o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!i){s=o+1;break}continue}t===-1&&(i=!1,t=o+1),c===46?r===-1?r=o:n!==1&&(n=1):r!==-1&&(n=-1)}return r===-1||t===-1||n===0||n===1&&r===t-1&&r===s+1?"":e.slice(r,t)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return $("/",e)},parse:function(e){m(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var s=e.charCodeAt(0),t=s===47,i;t?(r.root="/",i=1):i=0;for(var n=-1,o=0,c=-1,d=!0,u=e.length-1,f=0;u>=i;--u){if(s=e.charCodeAt(u),s===47){if(!d){o=u+1;break}continue}c===-1&&(d=!1,c=u+1),s===46?n===-1?n=u:f!==1&&(f=1):n!==-1&&(f=-1)}return n===-1||c===-1||f===0||f===1&&n===c-1&&n===o+1?c!==-1&&(o===0&&t?r.base=r.name=e.slice(1,c):r.base=r.name=e.slice(o,c)):(o===0&&t?(r.name=e.slice(1,n),r.base=e.slice(1,c)):(r.name=e.slice(o,n),r.base=e.slice(o,c)),r.ext=e.slice(n,c)),o>0?r.dir=e.slice(0,o-1):t&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};h.posix=h;var v=h;const I=T(v),M=({children:l})=>{const[e,r]=N.useState(null),s=_("files");return a.jsxs("main",{className:"grid grid-cols-[auto,1fr] h-full",children:[a.jsxs("section",{className:"flex flex-col min-h-full overflow-x-hidden overflow-y-auto pl-1 pr-1 border-0 border-r-[1px] border-container-border min-w-[10rem]",children:[a.jsx("h1",{className:"font-semibold text-container-fg text-3xl text-center pt-2 pb-2",children:s("APPLICATION_BRANDING")}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("div",{className:"w-full border-t-[1px] border-t-container-border"}),a.jsx(E,{children:s("CREATE")}),a.jsx(C,{children:s("UPLOAD")}),a.jsx("div",{className:"w-full border-t-[1px] border-t-container-border"}),a.jsx("h2",{className:"pl-2 pr-2 pb-0.5 pt-2",children:s("SHORTCUTS")}),e?e.map(t=>a.jsx(C,{className:"!pt-0.5 !pb-0.5",children:a.jsx("span",{className:"m-0",children:I.basename(t.path)})},t.path)):a.jsx(C,{children:"Add Home shortcut?"})]})]}),a.jsx("section",{className:"flex flex-col w-full min-h-full overflow-auto",children:l})]})},U=({path:l=""})=>{const e=g.useRef(null),[r,s]=g.useState(k(v.extname(l).replace(".",""))==="json");return g.useEffect(()=>{if(!e.current)return;const t=new z(e.current);w.postText("/app/files/get/file",{path:l},i=>{let n=i;r&&(n=JSON.stringify(JSON.parse(n),null,2));let o=new S(k(v.extname(l).replace(".","")));o||(o=new S("plainText")),console.log(n),console.log(o),t._debugRenderParsedString(n,o)})},[!!e.current,l,r]),a.jsxs("section",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"flex gap-1",children:a.jsx(P,{icon:b.ArrowSwitch,onClick:()=>{s(!r)}})}),a.jsx("div",{"data-yourdash-codestudio-editor":"true",className:"overflow-auto w-full p-2",ref:e})]})},O=({path:l=""})=>{const[e,r]=g.useState(null);return g.useEffect(()=>{w.postText("/app/files/get/file",{path:l},s=>{r(s)})},[l]),e?a.jsx("main",{className:"w-full h-full flex items-center justify-center overflow-auto",children:a.jsx("img",{alt:"",src:`${w.getInstanceUrl()}${e}`})}):null},Y=({path:l})=>{const[e,r]=N.useState(null);switch(N.useEffect(()=>{switch(I.extname(l).replace(".","")){case"jpg":case"jpeg":case"png":case"gif":case"webp":case"svg":case"avif":r("image");break;default:r("text")}},[l]),e){case"image":return a.jsx(O,{path:l});case"text":return a.jsx(U,{path:l});default:return a.jsx("main",{className:"w-full h-full flex items-center justify-center overflow-hidden font-semibold text-5xl tracking-wide animate__animated animate__fadeIn",children:a.jsx("h1",{children:"Detecting file type..."})})}},H="_files_rxwwk_6",G="_item_rxwwk_10",q="_itemButton_rxwwk_15",K="_itemIcon_rxwwk_22",x={files:H,item:G,itemButton:q,itemIcon:K},Q=()=>{const[l,e]=g.useState("/"),[r,s]=g.useState([]),t=_("files");return g.useEffect(()=>{w.postJson("/app/files/get/thumbnails-small",{path:l},i=>{if(Object.keys(i.files).length===0)return s([]);s((i==null?void 0:i.files)||[])})},[l]),a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:"p-2 flex flex-col bg-container-bg top-0 sticky gap-2 shadow-lg z-10",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{disabled:l==="/",onClick:()=>{e(v.join(l,".."))},icon:b.ChevronLeft}),a.jsx("span",{children:l})]}),!v.extname(l)&&a.jsxs("div",{className:D("bg-container-bg pl-2 pr-2 text-left transition-colors [transition:var(--transition)] hover:[transition:var(--transition-fast)] flex items-center"),children:[a.jsx(A,{icon:b.Info,className:"h-[calc(100%-0.35rem)] mr-1.5",color:"rgb(var(--container-fg))"}),a.jsx("span",{className:"mr-auto",children:t("NAME")}),a.jsx("span",{children:t("TYPE")})]})]}),v.extname(l)?a.jsx(Y,{path:l}):a.jsx("section",{className:x.files,children:r.map(i=>a.jsx(J,{items:[{name:"Delete",onClick(){return 0}},{name:"Pin to sidebar",onClick(){return 0}}],className:x.item,children:a.jsxs(B,{onClick:()=>{e(v.join(l,i.name))},className:x.itemButton,children:[i.icon===""?i.type==="dir"?a.jsx(A,{className:x.itemIcon,icon:b.FileDirectory}):a.jsx(A,{className:x.itemIcon,icon:b.File}):a.jsx("img",{className:x.itemIcon,alt:"",src:`${w.getInstanceUrl()}${i.icon}`}),a.jsx("span",{className:"pl-2 pr-2 text-ellipsis",children:i.name})]})},i.name))})]})},V=()=>a.jsx(M,{children:a.jsx(Q,{})}),ee=()=>a.jsx(F,{children:a.jsx(L,{index:!0,element:a.jsx(V,{})})});export{ee as default};
