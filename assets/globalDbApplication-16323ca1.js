import{r,j as e,C as b,I as f,U as i,e as d,w as u}from"./index-35df064e.js";import{T as g}from"./TextBox-f6a9c52c.js";import{T as j}from"./TextInput-b9d5c21b.js";const k=({currentItem:s,setCurrentItemData:t,items:l,setItems:n})=>{const[c,m]=r.useState(!1),[o,h]=r.useState(""),[x,p]=r.useState("");return r.useEffect(()=>{h(s.key),p(s.content)},[s]),e.jsx(b,{showBorder:!0,className:"bg-container-bg text-container-fg flex gap-2 !p-2 rounded-xl",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-auto",children:[e.jsx(j,{accessibleName:"Item Name",onBlur:a=>{h(a.currentTarget.value)},onChange:a=>{h(a)},defaultValue:o,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex flex-row gap-2 w-full child:flex-grow",children:[e.jsx(f,{icon:i.X,onClick:()=>m(!1),className:"flex-shrink-0"}),e.jsx(f,{icon:i.Check,onClick:()=>{if(!(o===""||x==="")){try{JSON.parse(x)}catch{return}if(o!==s.key){const a=l;delete a[s.key],n(a)}t(o,x),m(!1)}},className:"flex-shrink-0"}),e.jsx(f,{icon:i.Trash,onClick:()=>{const a=l;delete a[o],n(a)},className:"flex-shrink-0"})]})]}),e.jsx(g,{className:"flex flex-shrink h-full !min-h-[5rem] !max-h-max",defaultValue:x,onChange:a=>{p(a.currentTarget.value)}})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(f,{icon:c?i.ChevronUp:i.ChevronDown,onClick:()=>m(!c),className:"flex-shrink-0"})}),e.jsx("span",{className:"mt-auto mb-auto",children:o})]})})},w=()=>{const[s,t]=r.useState({});return r.useEffect(()=>{d.syncGetJson("/app/global_db/db",l=>{l.db&&t(l.db)})},[]),e.jsxs("div",{className:"flex flex-col gap-2 relative min-h-full bg-bg",children:[e.jsxs("div",{className:"flex flex-col w-full pb-20 h-full overflow-y-auto gap-2",children:[Object.keys(s).map(l=>e.jsx(k,{items:s,setItems:n=>{t(n)},setCurrentItemData:(n,c)=>{t({...s,[n]:JSON.parse(c)})},currentItem:{key:l,content:JSON.stringify(s[l],null,2)}},l)),e.jsx(u,{onClick:()=>{t({...s,[`untitled_${Math.floor(Math.random()*1e3)}`]:""})},children:"Create Database Key"})]}),e.jsxs(b,{showBorder:!0,className:"w-full flex gap-2 absolute bottom-0 left-0",children:[e.jsx(u,{onClick:()=>{d.postJson("/app/global_db/db",s,()=>{})},children:"Save"}),e.jsx(u,{onClick:()=>{d.syncGetJson("/app/global_db/db",l=>{l.db&&t(l.db)})},children:"Reload"}),e.jsx(u,{onClick:()=>{d.postJson("/app/global_db/db/force-write",s,()=>{})},children:"Force write"})]})]})};export{w as G};
